import com.google.gson.Gson;
import com.mongodb.MongoClient;
import com.mongodb.client.FindIterable;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;
import com.mongodb.util.JSON;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import model.*;
import model.requests.ConsultaRequest;
import org.bson.Document;
import service.AccessTokenService;
import service.AuthorizationTokenService;
import service.ConsultaService;

import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.*;

@Data
@Builder
@AllArgsConstructor
public class ConfereStatusProposta {

    private Ambiente ambiente;
    private String authorization;
    private String xBradAuth;
    private Usuario usuario;

    private MongoClient mongoClient;

    private String cpf;
    private Long proposta;


    public void listaSituacao() throws IOException {
        System.out.println("--------------------------------------------------------------------");
        System.out.println("Conferência da Situação da proposta (todos) - " + ambiente.getAmbiente());
        System.out.println("--------------------------------------------------------------------");

        MongoDatabase db = mongoClient.getDatabase("Bradescard");
        MongoCollection<Document> dbCollection = db.getCollection("propostas");
        FindIterable<Document> iterable = dbCollection.find();
        Iterator iterator = iterable.iterator();

        ArrayList<String> confereProposta = new ArrayList<>();
        Integer contador = 0;

        while (iterator.hasNext()) {
            contador++;
//            if (contador == 6) break;
            System.out.println("****************** Registro número:" + contador);
            if ((contador % 2000) == 0) {
                AuthorizationTokenService authorizationTokenService = new AuthorizationTokenService(ambiente);
                authorizationTokenService.setAuthorizationToken();
                AuthorizationToken authorizationToken = authorizationTokenService.getAuthorizationToken();
                authorization = authorizationToken.getAccessToken();
                Gson gson = new Gson();
                String json = gson.toJson(usuario);
                System.out.println("********** Json " + json);
                var accessTokenService = AccessTokenService.builder()
                        .ambiente(ambiente)
                        .authorization(authorizationToken.getAccessToken())
                        .body(json)
                        .build();
                accessTokenService.setBradSignature();
                BradSignature bradAuth = accessTokenService.getBradSignature();
                String xBradAuth = bradAuth.getToken().getAccessToken();
            }
            Document document = (Document) iterator.next();
            Document cliente = (Document) document.get("cliente");
            Document operador = (Document) document.get("operador");
            Document filial = (Document) operador.get("filial");

            StringBuilder proposta = new StringBuilder();
            Date dataAbertura = document.getDate("dataAbertura");
            SimpleDateFormat simpleDateFormat = new SimpleDateFormat("dd/MM/yyyy");
            SimpleDateFormat simpleTimeFormat = new SimpleDateFormat("HH:mm");
            proposta.append(simpleDateFormat.format(dataAbertura));
            proposta.append(";");
            proposta.append(simpleTimeFormat.format(dataAbertura));
            proposta.append(";");
            proposta.append(filial.getString("codigo"));
            proposta.append(";");
            proposta.append(cliente.getString("cpf"));
            proposta.append(";");
            proposta.append(document.getString("numero"));
            proposta.append(";");
            proposta.append(document.getString("codigoSituacao"));
            proposta.append(";");
            proposta.append(
                    consultaProposta(
                            cliente.getString("cpf"),
                            Long.valueOf(document.getString("numero")),
                            filial.getString("codigo")
                    )
            );
            confereProposta.add(proposta.toString());
        }

        System.out.println("data;hora;filial;cpf;proposta;statusVia;statusBradesco");
        for (String prop : confereProposta) {
            System.out.println(prop);
        }

    }

    private String consultaProposta(String cpf, Long proposta, String filial) {
        var gson = new Gson();

        Map<String, Integer> deParaFilial = new Hashtable<String, Integer>();
        deParaFilial.put("1000", 12101);
        deParaFilial.put("1001", 12102);
        deParaFilial.put("1002", 12103);
        deParaFilial.put("1003", 12104);
        deParaFilial.put("1005", 12105);
        deParaFilial.put("1008", 12106);
        deParaFilial.put("1009", 12107);
        deParaFilial.put("1010", 12108);
        deParaFilial.put("1011", 12109);
        deParaFilial.put("1013", 12110);
        deParaFilial.put("1014", 12111);
        deParaFilial.put("1015", 12112);
        deParaFilial.put("1018", 12113);
        deParaFilial.put("1021", 12114);
        deParaFilial.put("1022", 12115);
        deParaFilial.put("1023", 12116);
        deParaFilial.put("1024", 12117);
        deParaFilial.put("1025", 12118);
        deParaFilial.put("1026", 12119);
        deParaFilial.put("1028", 12120);
        deParaFilial.put("1029", 12121);
        deParaFilial.put("1031", 12122);
        deParaFilial.put("1032", 12123);
        deParaFilial.put("1033", 12124);
        deParaFilial.put("1034", 12125);
        deParaFilial.put("1035", 12126);
        deParaFilial.put("1036", 12127);
        deParaFilial.put("1039", 12128);
        deParaFilial.put("1040", 12129);
        deParaFilial.put("1042", 12130);
        deParaFilial.put("1043", 12131);
        deParaFilial.put("1044", 12132);
        deParaFilial.put("1045", 12133);
        deParaFilial.put("1046", 12134);
        deParaFilial.put("1049", 12135);
        deParaFilial.put("1050", 12136);
        deParaFilial.put("1051", 12137);
        deParaFilial.put("1052", 12138);
        deParaFilial.put("1053", 12139);
        deParaFilial.put("1054", 12140);
        deParaFilial.put("1055", 12141);
        deParaFilial.put("1056", 12142);
        deParaFilial.put("1057", 12143);
        deParaFilial.put("1058", 12144);
        deParaFilial.put("1059", 12145);
        deParaFilial.put("1060", 12146);
        deParaFilial.put("1061", 12147);
        deParaFilial.put("1062", 12148);
        deParaFilial.put("1066", 12149);
        deParaFilial.put("1067", 12150);
        deParaFilial.put("1068", 12151);
        deParaFilial.put("1069", 12152);
        deParaFilial.put("1071", 12153);
        deParaFilial.put("1072", 12154);
        deParaFilial.put("1073", 12155);
        deParaFilial.put("1074", 12156);
        deParaFilial.put("1075", 12157);
        deParaFilial.put("1076", 12158);
        deParaFilial.put("1077", 12159);
        deParaFilial.put("1078", 12160);
        deParaFilial.put("1080", 12161);
        deParaFilial.put("1082", 12162);
        deParaFilial.put("1083", 12163);
        deParaFilial.put("1084", 12164);
        deParaFilial.put("1085", 12165);
        deParaFilial.put("1086", 12166);
        deParaFilial.put("1089", 12167);
        deParaFilial.put("1090", 12168);
        deParaFilial.put("1092", 12169);
        deParaFilial.put("1093", 12170);
        deParaFilial.put("1094", 12171);
        deParaFilial.put("1095", 12172);
        deParaFilial.put("1096", 12173);
        deParaFilial.put("1098", 12174);
        deParaFilial.put("1099", 12175);
        deParaFilial.put("1100", 12176);
        deParaFilial.put("1101", 12177);
        deParaFilial.put("1103", 12178);
        deParaFilial.put("1105", 12179);
        deParaFilial.put("1107", 12180);
        deParaFilial.put("1108", 12181);
        deParaFilial.put("1109", 12182);
        deParaFilial.put("1110", 12183);
        deParaFilial.put("1111", 12184);
        deParaFilial.put("1112", 12185);
        deParaFilial.put("1113", 12186);
        deParaFilial.put("1114", 12187);
        deParaFilial.put("1115", 12188);
        deParaFilial.put("1116", 12189);
        deParaFilial.put("1119", 12190);
        deParaFilial.put("1120", 12191);
        deParaFilial.put("1121", 12192);
        deParaFilial.put("1122", 12193);
        deParaFilial.put("1124", 12194);
        deParaFilial.put("1125", 12195);
        deParaFilial.put("1126", 12196);
        deParaFilial.put("1127", 12197);
        deParaFilial.put("1128", 12198);
        deParaFilial.put("1129", 12199);
        deParaFilial.put("1130", 12200);
        deParaFilial.put("1131", 12201);
        deParaFilial.put("1133", 12202);
        deParaFilial.put("1134", 12203);
        deParaFilial.put("1135", 12204);
        deParaFilial.put("1136", 12205);
        deParaFilial.put("1137", 12206);
        deParaFilial.put("1138", 12207);
        deParaFilial.put("1140", 12208);
        deParaFilial.put("1141", 12209);
        deParaFilial.put("1142", 12210);
        deParaFilial.put("1143", 12211);
        deParaFilial.put("1144", 12212);
        deParaFilial.put("1146", 12213);
        deParaFilial.put("1147", 12214);
        deParaFilial.put("1148", 12215);
        deParaFilial.put("1149", 12216);
        deParaFilial.put("1150", 12217);
        deParaFilial.put("1151", 12218);
        deParaFilial.put("1152", 12219);
        deParaFilial.put("1153", 12220);
        deParaFilial.put("1154", 12221);
        deParaFilial.put("1155", 12222);
        deParaFilial.put("1156", 12223);
        deParaFilial.put("1157", 12224);
        deParaFilial.put("1158", 12225);
        deParaFilial.put("1159", 12226);
        deParaFilial.put("1160", 12227);
        deParaFilial.put("1161", 12228);
        deParaFilial.put("1162", 12229);
        deParaFilial.put("1163", 12230);
        deParaFilial.put("1164", 12231);
        deParaFilial.put("1165", 12232);
        deParaFilial.put("1166", 12233);
        deParaFilial.put("1167", 12234);
        deParaFilial.put("1168", 12235);
        deParaFilial.put("1169", 12236);
        deParaFilial.put("1170", 12237);
        deParaFilial.put("1171", 12238);
        deParaFilial.put("1172", 12239);
        deParaFilial.put("1173", 12240);
        deParaFilial.put("1174", 12241);
        deParaFilial.put("1175", 12242);
        deParaFilial.put("1176", 12243);
        deParaFilial.put("1177", 12244);
        deParaFilial.put("1178", 12245);
        deParaFilial.put("1180", 12246);
        deParaFilial.put("1181", 12247);
        deParaFilial.put("1182", 12248);
        deParaFilial.put("1183", 12249);
        deParaFilial.put("1184", 12250);
        deParaFilial.put("1185", 12251);
        deParaFilial.put("1187", 12252);
        deParaFilial.put("1188", 12253);
        deParaFilial.put("1189", 12254);
        deParaFilial.put("1190", 12255);
        deParaFilial.put("1191", 12256);
        deParaFilial.put("1192", 12257);
        deParaFilial.put("1193", 12258);
        deParaFilial.put("1194", 12259);
        deParaFilial.put("1195", 12260);
        deParaFilial.put("1196", 12261);
        deParaFilial.put("1197", 12262);
        deParaFilial.put("1199", 12263);
        deParaFilial.put("1201", 12264);
        deParaFilial.put("1202", 12265);
        deParaFilial.put("1203", 12266);
        deParaFilial.put("1204", 12267);
        deParaFilial.put("1205", 12268);
        deParaFilial.put("1206", 12269);
        deParaFilial.put("1207", 12270);
        deParaFilial.put("1208", 12271);
        deParaFilial.put("1209", 12272);
        deParaFilial.put("1210", 12273);
        deParaFilial.put("1211", 12274);
        deParaFilial.put("1212", 12275);
        deParaFilial.put("1213", 12276);
        deParaFilial.put("1214", 12277);
        deParaFilial.put("1215", 12278);
        deParaFilial.put("1216", 12279);
        deParaFilial.put("1217", 12280);
        deParaFilial.put("1218", 12281);
        deParaFilial.put("1219", 12282);
        deParaFilial.put("1220", 12283);
        deParaFilial.put("1221", 12284);
        deParaFilial.put("1223", 12285);
        deParaFilial.put("1224", 12286);
        deParaFilial.put("1226", 12287);
        deParaFilial.put("1228", 12288);
        deParaFilial.put("1229", 12289);
        deParaFilial.put("1230", 12290);
        deParaFilial.put("1231", 12291);
        deParaFilial.put("1233", 12292);
        deParaFilial.put("1234", 12293);
        deParaFilial.put("1235", 12294);
        deParaFilial.put("1236", 12295);
        deParaFilial.put("1237", 12296);
        deParaFilial.put("1238", 12297);
        deParaFilial.put("1239", 12298);
        deParaFilial.put("1240", 12299);
        deParaFilial.put("1242", 12300);
        deParaFilial.put("1244", 12301);
        deParaFilial.put("1245", 12302);
        deParaFilial.put("1246", 12303);
        deParaFilial.put("1247", 12304);
        deParaFilial.put("1248", 12305);
        deParaFilial.put("1249", 12306);
        deParaFilial.put("1250", 12307);
        deParaFilial.put("1251", 12308);
        deParaFilial.put("1252", 12309);
        deParaFilial.put("1253", 12310);
        deParaFilial.put("1255", 12311);
        deParaFilial.put("1256", 12312);
        deParaFilial.put("1258", 12313);
        deParaFilial.put("1260", 12314);
        deParaFilial.put("1261", 12315);
        deParaFilial.put("1262", 12316);
        deParaFilial.put("1263", 12317);
        deParaFilial.put("1264", 12318);
        deParaFilial.put("1265", 12319);
        deParaFilial.put("1266", 12320);
        deParaFilial.put("1267", 12321);
        deParaFilial.put("1268", 12322);
        deParaFilial.put("1269", 12323);
        deParaFilial.put("1270", 12324);
        deParaFilial.put("1271", 12325);
        deParaFilial.put("1273", 12326);
        deParaFilial.put("1276", 12327);
        deParaFilial.put("1277", 12328);
        deParaFilial.put("1278", 12329);
        deParaFilial.put("1279", 12330);
        deParaFilial.put("1280", 12331);
        deParaFilial.put("1281", 12332);
        deParaFilial.put("1282", 12333);
        deParaFilial.put("1283", 12334);
        deParaFilial.put("1285", 12335);
        deParaFilial.put("1286", 12336);
        deParaFilial.put("1287", 12337);
        deParaFilial.put("1288", 12338);
        deParaFilial.put("1289", 12339);
        deParaFilial.put("1291", 12340);
        deParaFilial.put("1293", 12341);
        deParaFilial.put("1294", 12342);
        deParaFilial.put("1295", 12343);
        deParaFilial.put("1296", 12344);
        deParaFilial.put("1297", 12345);
        deParaFilial.put("1298", 12346);
        deParaFilial.put("1301", 12347);
        deParaFilial.put("1302", 12348);
        deParaFilial.put("1304", 12349);
        deParaFilial.put("1305", 12350);
        deParaFilial.put("1306", 12351);
        deParaFilial.put("1308", 12352);
        deParaFilial.put("1309", 12353);
        deParaFilial.put("1310", 12354);
        deParaFilial.put("1311", 12355);
        deParaFilial.put("1312", 12356);
        deParaFilial.put("1313", 12357);
        deParaFilial.put("1315", 12358);
        deParaFilial.put("1316", 12359);
        deParaFilial.put("1317", 12360);
        deParaFilial.put("1318", 12361);
        deParaFilial.put("1319", 12362);
        deParaFilial.put("1320", 12363);
        deParaFilial.put("1321", 12364);
        deParaFilial.put("1322", 12365);
        deParaFilial.put("1323", 12366);
        deParaFilial.put("1324", 12367);
        deParaFilial.put("1325", 12368);
        deParaFilial.put("1326", 12369);
        deParaFilial.put("1327", 12370);
        deParaFilial.put("1328", 12371);
        deParaFilial.put("1330", 12372);
        deParaFilial.put("1331", 12373);
        deParaFilial.put("1332", 12374);
        deParaFilial.put("1333", 12375);
        deParaFilial.put("1334", 12376);
        deParaFilial.put("1336", 12377);
        deParaFilial.put("1339", 12378);
        deParaFilial.put("1340", 12379);
        deParaFilial.put("1341", 12380);
        deParaFilial.put("1342", 12381);
        deParaFilial.put("1343", 12382);
        deParaFilial.put("1344", 12383);
        deParaFilial.put("1345", 12384);
        deParaFilial.put("1346", 12385);
        deParaFilial.put("1347", 12386);
        deParaFilial.put("1348", 12387);
        deParaFilial.put("1349", 12388);
        deParaFilial.put("1350", 12389);
        deParaFilial.put("1351", 12390);
        deParaFilial.put("1353", 12391);
        deParaFilial.put("1356", 12392);
        deParaFilial.put("1357", 12393);
        deParaFilial.put("1358", 12394);
        deParaFilial.put("1359", 12395);
        deParaFilial.put("1360", 12396);
        deParaFilial.put("1361", 12397);
        deParaFilial.put("1362", 12398);
        deParaFilial.put("1363", 12399);
        deParaFilial.put("1364", 12400);
        deParaFilial.put("1365", 12401);
        deParaFilial.put("1366", 12402);
        deParaFilial.put("1367", 12403);
        deParaFilial.put("1368", 12404);
        deParaFilial.put("1369", 12405);
        deParaFilial.put("1370", 12406);
        deParaFilial.put("1371", 12407);
        deParaFilial.put("1372", 12408);
        deParaFilial.put("1373", 12409);
        deParaFilial.put("1374", 12410);
        deParaFilial.put("1375", 12411);
        deParaFilial.put("1377", 12412);
        deParaFilial.put("1378", 12413);
        deParaFilial.put("1379", 12414);
        deParaFilial.put("1381", 12415);
        deParaFilial.put("1383", 12416);
        deParaFilial.put("1384", 12417);
        deParaFilial.put("1386", 12418);
        deParaFilial.put("1387", 12419);
        deParaFilial.put("1388", 12420);
        deParaFilial.put("1389", 12421);
        deParaFilial.put("1390", 12422);
        deParaFilial.put("1391", 12423);
        deParaFilial.put("1392", 12424);
        deParaFilial.put("1393", 12425);
        deParaFilial.put("1394", 12426);
        deParaFilial.put("1395", 12427);
        deParaFilial.put("1396", 12428);
        deParaFilial.put("1397", 12429);
        deParaFilial.put("1398", 12430);
        deParaFilial.put("1402", 12431);
        deParaFilial.put("1405", 12432);
        deParaFilial.put("1406", 12433);
        deParaFilial.put("1407", 12434);
        deParaFilial.put("1408", 12435);
        deParaFilial.put("1409", 12436);
        deParaFilial.put("1410", 12437);
        deParaFilial.put("1411", 12438);
        deParaFilial.put("1413", 12439);
        deParaFilial.put("1414", 12440);
        deParaFilial.put("1415", 12441);
        deParaFilial.put("1416", 12442);
        deParaFilial.put("1417", 12443);
        deParaFilial.put("1418", 12444);
        deParaFilial.put("1419", 12445);
        deParaFilial.put("1420", 12446);
        deParaFilial.put("1421", 12447);
        deParaFilial.put("1422", 12448);
        deParaFilial.put("1423", 12449);
        deParaFilial.put("1424", 12450);
        deParaFilial.put("1425", 12451);
        deParaFilial.put("1426", 12452);
        deParaFilial.put("1430", 12453);
        deParaFilial.put("1431", 12454);
        deParaFilial.put("1434", 12455);
        deParaFilial.put("1435", 12456);
        deParaFilial.put("1436", 12457);
        deParaFilial.put("1437", 12458);
        deParaFilial.put("1438", 12459);
        deParaFilial.put("1439", 12460);
        deParaFilial.put("1444", 12461);
        deParaFilial.put("1448", 12462);
        deParaFilial.put("1450", 12463);
        deParaFilial.put("1452", 12464);
        deParaFilial.put("1453", 12465);
        deParaFilial.put("1455", 12466);
        deParaFilial.put("1456", 12467);
        deParaFilial.put("1457", 12468);
        deParaFilial.put("1458", 12469);
        deParaFilial.put("1459", 12470);
        deParaFilial.put("1460", 12471);
        deParaFilial.put("1461", 12472);
        deParaFilial.put("1462", 12473);
        deParaFilial.put("1463", 12474);
        deParaFilial.put("1464", 12475);
        deParaFilial.put("1465", 12476);
        deParaFilial.put("1466", 12477);
        deParaFilial.put("1467", 12478);
        deParaFilial.put("1469", 12479);
        deParaFilial.put("1470", 12480);
        deParaFilial.put("1471", 12481);
        deParaFilial.put("1472", 12482);
        deParaFilial.put("1473", 12483);
        deParaFilial.put("1476", 12484);
        deParaFilial.put("1477", 12485);
        deParaFilial.put("1479", 12486);
        deParaFilial.put("1480", 12487);
        deParaFilial.put("1481", 12488);
        deParaFilial.put("1482", 12489);
        deParaFilial.put("1483", 12490);
        deParaFilial.put("1484", 12491);
        deParaFilial.put("1485", 12492);
        deParaFilial.put("1486", 12493);
        deParaFilial.put("1487", 12494);
        deParaFilial.put("1489", 12495);
        deParaFilial.put("1490", 12496);
        deParaFilial.put("1492", 12497);
        deParaFilial.put("1493", 12498);
        deParaFilial.put("1494", 12499);
        deParaFilial.put("1495", 12500);
        deParaFilial.put("1496", 12501);
        deParaFilial.put("1497", 12502);
        deParaFilial.put("1498", 12503);
        deParaFilial.put("1499", 12504);
        deParaFilial.put("1502", 12505);
        deParaFilial.put("1503", 12506);
        deParaFilial.put("1504", 12507);
        deParaFilial.put("1505", 12508);
        deParaFilial.put("1506", 12509);
        deParaFilial.put("1507", 12510);
        deParaFilial.put("1508", 12511);
        deParaFilial.put("1509", 12512);
        deParaFilial.put("1510", 12513);
        deParaFilial.put("1511", 12514);
        deParaFilial.put("1515", 12515);
        deParaFilial.put("1516", 12516);
        deParaFilial.put("1517", 12517);
        deParaFilial.put("1519", 12518);
        deParaFilial.put("1520", 12519);
        deParaFilial.put("1521", 12520);
        deParaFilial.put("1523", 12521);
        deParaFilial.put("1524", 12522);
        deParaFilial.put("1525", 12523);
        deParaFilial.put("1527", 12524);
        deParaFilial.put("1528", 12525);
        deParaFilial.put("1529", 12526);
        deParaFilial.put("1530", 12527);
        deParaFilial.put("1531", 12528);
        deParaFilial.put("1532", 12529);
        deParaFilial.put("1533", 12530);
        deParaFilial.put("1534", 12531);
        deParaFilial.put("1535", 12532);
        deParaFilial.put("1536", 12533);
        deParaFilial.put("1537", 12534);
        deParaFilial.put("1539", 12535);
        deParaFilial.put("1540", 12536);
        deParaFilial.put("1541", 12537);
        deParaFilial.put("1542", 12538);
        deParaFilial.put("1543", 12539);
        deParaFilial.put("1544", 12540);
        deParaFilial.put("1545", 12541);
        deParaFilial.put("1546", 12542);
        deParaFilial.put("1548", 12543);
        deParaFilial.put("1549", 12544);
        deParaFilial.put("1550", 12545);
        deParaFilial.put("1552", 12546);
        deParaFilial.put("1553", 12547);
        deParaFilial.put("1556", 12548);
        deParaFilial.put("1557", 12549);
        deParaFilial.put("1558", 12550);
        deParaFilial.put("1560", 12551);
        deParaFilial.put("1563", 12552);
        deParaFilial.put("1564", 12553);
        deParaFilial.put("1565", 12554);
        deParaFilial.put("1568", 12555);
        deParaFilial.put("1569", 12556);
        deParaFilial.put("1570", 12557);
        deParaFilial.put("1571", 12558);
        deParaFilial.put("1572", 12559);
        deParaFilial.put("1573", 12560);
        deParaFilial.put("1575", 12561);
        deParaFilial.put("1577", 12562);
        deParaFilial.put("1578", 12563);
        deParaFilial.put("1579", 12564);
        deParaFilial.put("1581", 12565);
        deParaFilial.put("1582", 12566);
        deParaFilial.put("1583", 12567);
        deParaFilial.put("1586", 12568);
        deParaFilial.put("1590", 12569);
        deParaFilial.put("1591", 12570);
        deParaFilial.put("1592", 12571);
        deParaFilial.put("1593", 12572);
        deParaFilial.put("1594", 12573);
        deParaFilial.put("1595", 12574);
        deParaFilial.put("1596", 12575);
        deParaFilial.put("1599", 12576);
        deParaFilial.put("1601", 12577);
        deParaFilial.put("1603", 12578);
        deParaFilial.put("1607", 12579);
        deParaFilial.put("1609", 12580);
        deParaFilial.put("1610", 12581);
        deParaFilial.put("1612", 12582);
        deParaFilial.put("1613", 12583);
        deParaFilial.put("1614", 12584);
        deParaFilial.put("1615", 12585);
        deParaFilial.put("1616", 12586);
        deParaFilial.put("1618", 12587);
        deParaFilial.put("1621", 12588);
        deParaFilial.put("1623", 12589);
        deParaFilial.put("1625", 12590);
        deParaFilial.put("1626", 12591);
        deParaFilial.put("1627", 12592);
        deParaFilial.put("1629", 12593);
        deParaFilial.put("1632", 12594);
        deParaFilial.put("1633", 12595);
        deParaFilial.put("1634", 12596);
        deParaFilial.put("1636", 12597);
        deParaFilial.put("1638", 12598);
        deParaFilial.put("1639", 12599);
        deParaFilial.put("1641", 12600);
        deParaFilial.put("1642", 12601);
        deParaFilial.put("1645", 12602);
        deParaFilial.put("1646", 12603);
        deParaFilial.put("1648", 12604);
        deParaFilial.put("1651", 12605);
        deParaFilial.put("1652", 12606);
        deParaFilial.put("1653", 12607);
        deParaFilial.put("1654", 12608);
        deParaFilial.put("1655", 12609);
        deParaFilial.put("1657", 12610);
        deParaFilial.put("1659", 12611);
        deParaFilial.put("1660", 12612);
        deParaFilial.put("1661", 12613);
        deParaFilial.put("1663", 12614);
        deParaFilial.put("1664", 12615);
        deParaFilial.put("1665", 12616);
        deParaFilial.put("1666", 12617);
        deParaFilial.put("1667", 12618);
        deParaFilial.put("1669", 12619);
        deParaFilial.put("1670", 12620);
        deParaFilial.put("1671", 12621);
        deParaFilial.put("1672", 12622);
        deParaFilial.put("1676", 12623);
        deParaFilial.put("1678", 12624);
        deParaFilial.put("1679", 12625);
        deParaFilial.put("1681", 12626);
        deParaFilial.put("1682", 12627);
        deParaFilial.put("1683", 12628);
        deParaFilial.put("1685", 12629);
        deParaFilial.put("1686", 12630);
        deParaFilial.put("1687", 12631);
        deParaFilial.put("1688", 12632);
        deParaFilial.put("1689", 12633);
        deParaFilial.put("1691", 12634);
        deParaFilial.put("1692", 12635);
        deParaFilial.put("1693", 12636);
        deParaFilial.put("1694", 12637);
        deParaFilial.put("1696", 12638);
        deParaFilial.put("1697", 12639);
        deParaFilial.put("1698", 12640);
        deParaFilial.put("1699", 12641);
        deParaFilial.put("1700", 12642);
        deParaFilial.put("1702", 12643);
        deParaFilial.put("1704", 12644);
        deParaFilial.put("1705", 12645);
        deParaFilial.put("1706", 12646);
        deParaFilial.put("1707", 12647);
        deParaFilial.put("1708", 12648);
        deParaFilial.put("1709", 12649);
        deParaFilial.put("1711", 12650);
        deParaFilial.put("1712", 12651);
        deParaFilial.put("1714", 12652);
        deParaFilial.put("1715", 12653);
        deParaFilial.put("1717", 12654);
        deParaFilial.put("1718", 12655);
        deParaFilial.put("1720", 12656);
        deParaFilial.put("1723", 12657);
        deParaFilial.put("1724", 12658);
        deParaFilial.put("1725", 12659);
        deParaFilial.put("1726", 12660);
        deParaFilial.put("1727", 12661);
        deParaFilial.put("1728", 12662);
        deParaFilial.put("1729", 12663);
        deParaFilial.put("1730", 12664);
        deParaFilial.put("1731", 12665);
        deParaFilial.put("1732", 12666);
        deParaFilial.put("1733", 12667);
        deParaFilial.put("1734", 12668);
        deParaFilial.put("1737", 12669);
        deParaFilial.put("1738", 12670);
        deParaFilial.put("1739", 12671);
        deParaFilial.put("1740", 12672);
        deParaFilial.put("1741", 12673);
        deParaFilial.put("1742", 12674);
        deParaFilial.put("1743", 12675);
        deParaFilial.put("1744", 12676);
        deParaFilial.put("1745", 12677);
        deParaFilial.put("1746", 12678);
        deParaFilial.put("1747", 12679);
        deParaFilial.put("1748", 12680);
        deParaFilial.put("1749", 12681);
        deParaFilial.put("1750", 12682);
        deParaFilial.put("1751", 12683);
        deParaFilial.put("1752", 12684);
        deParaFilial.put("1753", 12685);
        deParaFilial.put("1754", 12686);
        deParaFilial.put("1755", 12687);
        deParaFilial.put("1756", 12688);
        deParaFilial.put("1759", 12689);
        deParaFilial.put("1763", 12690);
        deParaFilial.put("1764", 12691);
        deParaFilial.put("1765", 12692);
        deParaFilial.put("1766", 12693);
        deParaFilial.put("1770", 12694);
        deParaFilial.put("1771", 12695);
        deParaFilial.put("1772", 12696);
        deParaFilial.put("1773", 12697);
        deParaFilial.put("1775", 12698);
        deParaFilial.put("1777", 12699);
        deParaFilial.put("1779", 12700);
        deParaFilial.put("1780", 12701);
        deParaFilial.put("1781", 12702);
        deParaFilial.put("1782", 12703);
        deParaFilial.put("1783", 12704);
        deParaFilial.put("1785", 12705);
        deParaFilial.put("1786", 12706);
        deParaFilial.put("1787", 12707);
        deParaFilial.put("1788", 12708);
        deParaFilial.put("1789", 12709);
        deParaFilial.put("1790", 12710);
        deParaFilial.put("1791", 12711);
        deParaFilial.put("1794", 12712);
        deParaFilial.put("1795", 12713);
        deParaFilial.put("1797", 12714);
        deParaFilial.put("1799", 12715);
        deParaFilial.put("1800", 12716);
        deParaFilial.put("1801", 12717);
        deParaFilial.put("1802", 12718);
        deParaFilial.put("1803", 12719);
        deParaFilial.put("1804", 12720);
        deParaFilial.put("1805", 12721);
        deParaFilial.put("1806", 12722);
        deParaFilial.put("1810", 12723);
        deParaFilial.put("1811", 12724);
        deParaFilial.put("1812", 12725);
        deParaFilial.put("1813", 12726);
        deParaFilial.put("1814", 12727);
        deParaFilial.put("1815", 12728);
        deParaFilial.put("1817", 12729);
        deParaFilial.put("1819", 12730);
        deParaFilial.put("1821", 12731);
        deParaFilial.put("1822", 12732);
        deParaFilial.put("1824", 12733);
        deParaFilial.put("1827", 12734);
        deParaFilial.put("1828", 12735);
        deParaFilial.put("1830", 12736);
        deParaFilial.put("1832", 12737);
        deParaFilial.put("1833", 12738);
        deParaFilial.put("1835", 12739);
        deParaFilial.put("1837", 12740);
        deParaFilial.put("1838", 12741);
        deParaFilial.put("1839", 12742);
        deParaFilial.put("1841", 12743);
        deParaFilial.put("1845", 12744);
        deParaFilial.put("1846", 12745);
        deParaFilial.put("1848", 12746);
        deParaFilial.put("1852", 12747);
        deParaFilial.put("1853", 12748);
        deParaFilial.put("1854", 12749);
        deParaFilial.put("1855", 12750);
        deParaFilial.put("1860", 12751);
        deParaFilial.put("1862", 12752);
        deParaFilial.put("1864", 12753);
        deParaFilial.put("1865", 12754);
        deParaFilial.put("1867", 12755);
        deParaFilial.put("1886", 12756);
        deParaFilial.put("1897", 12757);
        deParaFilial.put("1900", 12758);
        deParaFilial.put("1903", 12759);
        deParaFilial.put("1904", 12760);
        deParaFilial.put("1906", 12761);
        deParaFilial.put("1907", 12762);
        deParaFilial.put("1909", 12763);
        deParaFilial.put("1918", 12764);
        deParaFilial.put("1919", 12765);
        deParaFilial.put("1921", 12766);
        deParaFilial.put("1932", 12767);
        deParaFilial.put("1937", 12768);
        deParaFilial.put("1938", 12769);
        deParaFilial.put("1939", 12770);
        deParaFilial.put("1944", 12771);
        deParaFilial.put("1949", 12772);
        deParaFilial.put("1953", 12773);
        deParaFilial.put("1958", 12774);
        deParaFilial.put("1959", 12775);
        deParaFilial.put("1963", 12776);
        deParaFilial.put("1965", 12777);
        deParaFilial.put("1966", 12778);
        deParaFilial.put("1967", 12779);
        deParaFilial.put("1972", 12780);
        deParaFilial.put("1980", 12781);
        deParaFilial.put("1981", 12782);
        deParaFilial.put("1998", 12783);
        deParaFilial.put("2024", 12784);
        deParaFilial.put("2025", 12785);
        deParaFilial.put("2026", 12786);
        deParaFilial.put("2027", 12787);
        deParaFilial.put("2032", 12788);
        deParaFilial.put("2034", 12789);
        deParaFilial.put("2035", 12790);
        deParaFilial.put("2038", 12791);
        deParaFilial.put("2039", 12792);
        deParaFilial.put("2041", 12793);
        deParaFilial.put("2042", 12794);
        deParaFilial.put("2043", 12795);
        deParaFilial.put("2044", 12796);
        deParaFilial.put("2045", 12797);
        deParaFilial.put("2046", 12798);
        deParaFilial.put("2047", 12799);
        deParaFilial.put("2048", 12800);
        deParaFilial.put("2049", 12801);
        deParaFilial.put("2051", 12802);
        deParaFilial.put("2052", 12803);
        deParaFilial.put("2054", 12804);
        deParaFilial.put("2056", 12805);
        deParaFilial.put("2057", 12806);
        deParaFilial.put("2058", 12807);
        deParaFilial.put("2059", 12808);
        deParaFilial.put("2060", 12809);
        deParaFilial.put("2061", 12810);
        deParaFilial.put("2062", 12811);
        deParaFilial.put("2063", 12812);
        deParaFilial.put("2064", 12813);
        deParaFilial.put("2065", 12814);
        deParaFilial.put("2066", 12815);
        deParaFilial.put("2067", 12816);
        deParaFilial.put("2068", 12817);
        deParaFilial.put("2069", 12818);
        deParaFilial.put("2070", 12819);
        deParaFilial.put("2071", 12820);
        deParaFilial.put("2072", 12821);
        deParaFilial.put("2073", 12822);
        deParaFilial.put("2075", 12823);
        deParaFilial.put("2076", 12824);
        deParaFilial.put("2077", 12825);
        deParaFilial.put("2079", 12826);
        deParaFilial.put("2080", 12827);
        deParaFilial.put("2081", 12828);
        deParaFilial.put("2082", 12829);
        deParaFilial.put("2083", 12830);
        deParaFilial.put("2084", 12831);
        deParaFilial.put("2086", 12832);
        deParaFilial.put("2087", 12833);
        deParaFilial.put("2091", 12834);
        deParaFilial.put("2092", 12835);
        deParaFilial.put("2095", 12836);
        deParaFilial.put("2096", 12837);
        deParaFilial.put("2097", 12838);
        deParaFilial.put("2098", 12839);
        deParaFilial.put("2099", 12840);
        deParaFilial.put("2101", 12841);
        deParaFilial.put("2102", 12842);
        deParaFilial.put("2103", 12843);
        deParaFilial.put("2104", 12844);
        deParaFilial.put("2105", 12845);
        deParaFilial.put("2106", 12846);
        deParaFilial.put("2111", 12847);
        deParaFilial.put("2112", 12848);
        deParaFilial.put("2113", 12849);
        deParaFilial.put("2115", 12850);
        deParaFilial.put("2116", 12851);
        deParaFilial.put("2117", 12852);
        deParaFilial.put("2118", 12853);
        deParaFilial.put("2119", 12854);
        deParaFilial.put("2120", 12855);
        deParaFilial.put("2121", 12856);
        deParaFilial.put("2123", 12857);
        deParaFilial.put("2129", 12858);
        deParaFilial.put("2130", 12859);
        deParaFilial.put("2132", 12860);
        deParaFilial.put("2133", 12861);
        deParaFilial.put("2134", 12862);
        deParaFilial.put("2141", 12863);
        deParaFilial.put("2142", 12864);
        deParaFilial.put("2143", 12865);
        deParaFilial.put("2146", 12866);
        deParaFilial.put("2147", 12867);
        deParaFilial.put("2148", 12868);
        deParaFilial.put("2149", 12869);
        deParaFilial.put("2151", 12870);
        deParaFilial.put("2152", 12871);
        deParaFilial.put("2153", 12872);
        deParaFilial.put("2154", 12873);
        deParaFilial.put("2155", 12874);
        deParaFilial.put("2157", 12875);
        deParaFilial.put("2158", 12876);
        deParaFilial.put("2159", 12877);
        deParaFilial.put("2160", 12878);
        deParaFilial.put("2161", 12879);
        deParaFilial.put("2162", 12880);
        deParaFilial.put("2164", 12881);
        deParaFilial.put("2167", 12882);
        deParaFilial.put("2168", 12883);
        deParaFilial.put("2169", 12884);
        deParaFilial.put("2170", 12885);
        deParaFilial.put("2171", 12886);
        deParaFilial.put("2172", 12887);
        deParaFilial.put("2173", 12888);
        deParaFilial.put("2174", 12889);
        deParaFilial.put("2176", 12890);
        deParaFilial.put("2177", 12891);
        deParaFilial.put("2179", 12892);
        deParaFilial.put("2180", 12893);
        deParaFilial.put("2182", 12894);
        deParaFilial.put("2184", 12895);
        deParaFilial.put("2185", 12896);
        deParaFilial.put("2192", 12897);
        deParaFilial.put("2197", 12898);
        deParaFilial.put("2199", 12899);
        deParaFilial.put("2201", 12900);
        deParaFilial.put("2202", 12901);
        deParaFilial.put("2203", 12902);
        deParaFilial.put("2204", 12903);
        deParaFilial.put("2209", 12904);
        deParaFilial.put("2210", 12905);
        deParaFilial.put("2211", 12906);
        deParaFilial.put("2213", 12907);
        deParaFilial.put("2216", 12908);
        deParaFilial.put("2217", 12909);
        deParaFilial.put("2218", 12910);
        deParaFilial.put("2223", 12911);
        deParaFilial.put("2224", 12912);
        deParaFilial.put("2227", 12913);
        deParaFilial.put("2228", 12914);
        deParaFilial.put("2233", 12915);
        deParaFilial.put("2234", 12916);
        deParaFilial.put("2236", 12917);
        deParaFilial.put("2238", 12918);
        deParaFilial.put("2239", 12919);
        deParaFilial.put("2240", 12920);
        deParaFilial.put("2244", 12921);
        deParaFilial.put("2245", 12922);
        deParaFilial.put("2246", 12923);
        deParaFilial.put("2247", 12924);
        deParaFilial.put("2248", 12925);
        deParaFilial.put("2249", 12926);
        deParaFilial.put("2251", 12927);
        deParaFilial.put("2252", 12928);
        deParaFilial.put("2253", 12929);
        deParaFilial.put("2254", 12930);
        deParaFilial.put("2255", 12931);
        deParaFilial.put("2257", 12932);
        deParaFilial.put("2258", 12933);
        deParaFilial.put("2259", 12934);
        deParaFilial.put("2264", 12935);
        deParaFilial.put("2268", 12936);
        deParaFilial.put("2270", 12937);
        deParaFilial.put("2272", 12938);
        deParaFilial.put("2273", 12939);
        deParaFilial.put("2275", 12940);
        deParaFilial.put("2276", 12941);
        deParaFilial.put("2278", 12942);
        deParaFilial.put("2283", 12943);
        deParaFilial.put("2305", 12944);
        deParaFilial.put("2302", 12988);
        deParaFilial.put("2403", 13039);
        deParaFilial.put("2214", 12965);
        deParaFilial.put("2291", 12983);
        deParaFilial.put("2341", 13009);
        deParaFilial.put("2445", 13026);
        deParaFilial.put("2424", 13030);
        deParaFilial.put("2324", 13032);
        deParaFilial.put("2387", 13035);
        deParaFilial.put("2421", 13043);
        deParaFilial.put("2282", 13045);
        deParaFilial.put("2300", 13046);
        deParaFilial.put("2432", 13052);
        deParaFilial.put("2394", 13055);
        deParaFilial.put("2426", 13057);
        deParaFilial.put("2406", 13068);
        deParaFilial.put("2437", 13074);
        deParaFilial.put("2462", 13078);
        deParaFilial.put("2451", 13101);
        deParaFilial.put("2355", 13104);
        deParaFilial.put("2326", 13105);
        deParaFilial.put("2412", 13108);
        deParaFilial.put("2467", 13109);
        deParaFilial.put("2230", 13113);
        deParaFilial.put("2316", 13117);
        deParaFilial.put("2382", 13072);
        deParaFilial.put("2395", 13029);
        deParaFilial.put("2319", 12999);
        deParaFilial.put("2391", 13037);
        deParaFilial.put("2183", 12963);
        deParaFilial.put("2205", 13107);
        deParaFilial.put("2206", 12964);
        deParaFilial.put("2219", 12966);
        deParaFilial.put("2237", 12967);
        deParaFilial.put("2250", 12968);
        deParaFilial.put("2256", 12969);
        deParaFilial.put("2261", 12970);
        deParaFilial.put("2262", 12971);
        deParaFilial.put("2265", 12972);
        deParaFilial.put("2266", 12973);
        deParaFilial.put("2267", 12974);
        deParaFilial.put("2269", 12975);
        deParaFilial.put("2280", 13069);
        deParaFilial.put("2281", 12976);
        deParaFilial.put("2284", 12977);
        deParaFilial.put("2286", 12978);
        deParaFilial.put("2287", 12979);
        deParaFilial.put("2288", 12980);
        deParaFilial.put("2289", 12981);
        deParaFilial.put("2290", 12982);
        deParaFilial.put("2295", 12984);
        deParaFilial.put("2297", 12985);
        deParaFilial.put("2298", 13031);
        deParaFilial.put("2299", 12986);
        deParaFilial.put("2301", 12987);
        deParaFilial.put("2303", 12989);
        deParaFilial.put("2306", 12990);
        deParaFilial.put("2309", 12992);
        deParaFilial.put("2310", 12993);
        deParaFilial.put("2311", 12994);
        deParaFilial.put("2313", 13100);
        deParaFilial.put("2314", 12995);
        deParaFilial.put("2315", 12996);
        deParaFilial.put("2317", 12997);
        deParaFilial.put("2318", 12998);
        deParaFilial.put("2320", 13000);
        deParaFilial.put("2321", 13001);
        deParaFilial.put("2322", 13002);
        deParaFilial.put("2323", 13070);
        deParaFilial.put("2328", 13003);
        deParaFilial.put("2330", 13004);
        deParaFilial.put("2332", 13005);
        deParaFilial.put("2334", 13006);
        deParaFilial.put("2335", 13007);
        deParaFilial.put("2337", 13008);
        deParaFilial.put("2339", 13033);
        deParaFilial.put("2342", 13120);
        deParaFilial.put("2345", 13010);
        deParaFilial.put("2346", 13079);
        deParaFilial.put("2347", 13011);
        deParaFilial.put("2348", 13012);
        deParaFilial.put("2349", 13013);
        deParaFilial.put("2351", 13014);
        deParaFilial.put("2358", 13015);
        deParaFilial.put("2359", 13016);
        deParaFilial.put("2360", 13047);
        deParaFilial.put("2368", 13034);
        deParaFilial.put("2369", 13028);
        deParaFilial.put("2370", 13017);
        deParaFilial.put("2371", 13018);
        deParaFilial.put("2372", 13019);
        deParaFilial.put("2373", 13058);
        deParaFilial.put("2377", 13071);
        deParaFilial.put("2380", 13020);
        deParaFilial.put("2384", 13021);
        deParaFilial.put("2388", 13036);
        deParaFilial.put("2392", 13022);
        deParaFilial.put("2396", 13023);
        deParaFilial.put("2397", 13080);
        deParaFilial.put("2398", 13048);
        deParaFilial.put("2399", 13038);
        deParaFilial.put("2405", 13040);
        deParaFilial.put("2407", 13041);
        deParaFilial.put("2408", 13049);
        deParaFilial.put("2409", 13024);
        deParaFilial.put("2411", 13025);
        deParaFilial.put("2418", 13042);
        deParaFilial.put("2419", 13124);
        deParaFilial.put("2422", 13050);
        deParaFilial.put("2423", 13056);
        deParaFilial.put("2427", 13125);
        deParaFilial.put("2428", 13051);
        deParaFilial.put("2430", 13073);
        deParaFilial.put("2436", 13115);
        deParaFilial.put("2439", 13116);
        deParaFilial.put("2443", 13044);
        deParaFilial.put("2446", 13053);
        deParaFilial.put("2450", 13123);
        deParaFilial.put("2455", 13075);
        deParaFilial.put("2456", 13106);
        deParaFilial.put("2459", 13076);
        deParaFilial.put("2463", 13122);
        deParaFilial.put("2464", 13054);
        deParaFilial.put("2481", 13081);
        deParaFilial.put("2485", 13102);
        deParaFilial.put("2486", 13082);
        deParaFilial.put("2491", 13121);
        deParaFilial.put("3000", 13027);
        deParaFilial.put("5001", 13103);
        deParaFilial.put("5002", 12962);
        deParaFilial.put("9004", 13111);
        deParaFilial.put("9005", 13112);
        deParaFilial.put("2383", 13118);
        deParaFilial.put("2425", 13119);
        deParaFilial.put("2477", 13110);
        deParaFilial.put("2308", 12991);
        deParaFilial.put("2452", 13077);
        deParaFilial.put("2498", 13128);
        deParaFilial.put("2474", 13130);
        deParaFilial.put("2472", 13129);
        deParaFilial.put("2470", 13127);
        deParaFilial.put("2381", 13138);
        deParaFilial.put("2494", 13194);

        Usuario usuario = Usuario.builder()
                .usuario("C05066794")
                .canal(536)
                .origem(145)
                .tipoPontoVenda(1)
                .numeroPontoVenda(deParaFilial.get(filial))
                .build();
        String jsonUser = gson.toJson(usuario);

        var consultaRequest = ConsultaRequest.builder()
                .canal(usuario.getCanal())
                .origem(usuario.getOrigem())
                .tipoPontoVenda(usuario.getTipoPontoVenda())
                .numeroPontoVenda(deParaFilial.get(filial))
                .cpf(cpf)
                .numeroProposta(proposta)
                .build();
        String body = gson.toJson(consultaRequest);

        var consultaService = ConsultaService.builder()
                .endpoint("/cartoes/aquisicao/parceiros/v1/proposta")
                .ambiente(ambiente)
                .authorization(authorization)
                .xBradAuth(getToken(jsonUser))
                .body(body)
                .build();
        var consulta = consultaService.consulta();

        StatusProposta[] propostas = gson.fromJson(consulta, StatusProposta[].class);
        String[] statusString = {
                "Aprovada",
                "Em analise",
                "Negada",
                "Cancelada",
                "Aguardando Retorno Aceite",
                "Em Digitacao",
                "Pendente",
                "Em reanalise",
                "Consulta previa",
                "Erro efetivacao"
        };

        String retorno;
        if (propostas == null) {
            retorno = "Nao encontrada";
        } else {
            retorno = statusString[propostas[0].getSituacao() - 1];
        }
        return retorno;
    }

    public String getToken(String usuario) {
        var accessTokenService = AccessTokenService.builder()
                .ambiente(ambiente)
                .authorization(authorization)
                .body(usuario)
                .build();
        accessTokenService.setBradSignature();
        BradSignature bradAuth = accessTokenService.getBradSignature();
        String xBradAuth = bradAuth.getToken().getAccessToken();
        return xBradAuth;
    }
}
